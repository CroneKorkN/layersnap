#!/bin/bash

# libs
source /home/ckn/layersnap/params
source /home/ckn/layersnap/actions

# paths and vars
TargetDir="$TargetDir"
DirName="$(basename $TargetDir)"
PoolDir="$(dirname $TargetDir)/.layersnap/$DirName"

# conntroller
case $ACTION in

  # status
  status)
    ls_status
  ;;
  
  # snapshot
  snapshot)
    ls_snapshot
  ;;
  
  #merge
  merge)
    if [ -d "$PoolDir" ]; then
      ls_merge
    else
      echo ERROR: $TargetDir is not layersnapped, so nothing to merge!
    fi
  ;;
  
  #restore
  restore)
    if [ -d "$PoolDir" ]; then
      ls_restore
    else
      echo ERROR: $TargetDir is not layersnapped, so nothing to restore!
    fi
  ;;
  
esac
